kind: remote
metadata:
  name: stream-viewer
  tag: ''
  hash: 9121590615f9d89616502098a7c4b78e41f71f81
  project: default
spec:
  command: ''
  args: []
  image: ''
  entry_points:
    init_context:
      name: init_context
      doc: ''
      parameters:
      - name: context
        default: ''
      outputs:
      - default: ''
      lineno: 7
    handler:
      name: handler
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: event
        default: ''
      outputs:
      - default: ''
      lineno: 24
  description: ''
  min_replicas: 1
  max_replicas: 4
  env: []
  base_spec:
    apiVersion: nuclio.io/v1
    kind: Function
    metadata:
      annotations:
        nuclio.io/generated_by: function generated from 27-09-2020 by admin
      labels: {}
      name: stream-viewer
    spec:
      build:
        baseImage: mlrun/mlrun
        commands:
        - pip install v3io
        functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IHYzaW8uZGF0YXBsYW5lCmltcG9ydCBqc29uCmltcG9ydCBvcwoKZGVmIGluaXRfY29udGV4dChjb250ZXh0KToKICAgIGFjY2Vzc19rZXkgPSBvcy5nZXRlbnYoJ1YzSU9fQUNDRVNTX0tFWScsIE5vbmUpCiAgICBzZXRhdHRyKGNvbnRleHQsICdjb250YWluZXInLCBvcy5nZXRlbnYoJ1YzSU9fQ09OVEFJTkVSJywgJ2JpZ2RhdGEnKSkKICAgIHNldGF0dHIoY29udGV4dCwgJ3N0cmVhbV9wYXRoJywgb3MuZ2V0ZW52KCdTVE9DS1NfU1RSRUFNJywgJ3N0b2Nrcy9zdG9ja3Nfc3RyZWFtJykpCiAgICAKICAgIHYzaW9fY2xpZW50ID0gdjNpby5kYXRhcGxhbmUuQ2xpZW50KGVuZHBvaW50PW9zLmdldGVudignVjNJT19BUEknLCBOb25lKSwgYWNjZXNzX2tleT1hY2Nlc3Nfa2V5KQogICAgc2V0YXR0cihjb250ZXh0LCAnZGF0YScsIFtdKQogICAgc2V0YXR0cihjb250ZXh0LCAndjNpb19jbGllbnQnLCB2M2lvX2NsaWVudCkgCiAgICBzZXRhdHRyKGNvbnRleHQsICdsaW1pdCcsIG9zLmdldGVudignTElNSVQnLCAxMCkpCiAgICB0cnk6CiAgICAgICAgcmVzcCA9IHYzaW9fY2xpZW50LnNlZWtfc2hhcmQoY29udGFpbmVyPWNvbnRleHQuY29udGFpbmVyLCBwYXRoPWYne2NvbnRleHQuc3RyZWFtX3BhdGh9LzAnLCBzZWVrX3R5cGU9J0VBUkxJRVNUJykKICAgICAgICBzZXRhdHRyKGNvbnRleHQsICduZXh0X2xvY2F0aW9uJywgcmVzcC5vdXRwdXQubG9jYXRpb24pCiAgICBleGNlcHQ6CiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygnU3RyZWFtIG5vdCB1cGRhdGVkIHlldCcpCiAgICAKCiAgICAKZGVmIGhhbmRsZXIoY29udGV4dCwgZXZlbnQpOgogICAgCiAgICBpZiBoYXNhdHRyKGNvbnRleHQsICduZXh0X2xvY2F0aW9uJyk6CiAgICAgICAgcmVzcCA9IGNvbnRleHQudjNpb19jbGllbnQuZ2V0X3JlY29yZHMoY29udGFpbmVyPWNvbnRleHQuY29udGFpbmVyLCBwYXRoPWYne2NvbnRleHQuc3RyZWFtX3BhdGh9LzAnLCBsb2NhdGlvbj1jb250ZXh0Lm5leHRfbG9jYXRpb24sIGxpbWl0PWNvbnRleHQubGltaXQpCiAgICBlbHNlOgogICAgICAgIHJlc3AgPSBjb250ZXh0LnYzaW9fY2xpZW50LnNlZWtfc2hhcmQoY29udGFpbmVyPWNvbnRleHQuY29udGFpbmVyLCBwYXRoPWYne2NvbnRleHQuc3RyZWFtX3BhdGh9LzAnLCBzZWVrX3R5cGU9J0VBUkxJRVNUJykKICAgICAgICBzZXRhdHRyKGNvbnRleHQsICduZXh0X2xvY2F0aW9uJywgcmVzcC5vdXRwdXQubG9jYXRpb24pCiAgICBjb250ZXh0Lm5leHRfbG9jYXRpb24gPSByZXNwLm91dHB1dC5uZXh0X2xvY2F0aW9uCiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdsb2NhdGlvbjogJXMnLCBjb250ZXh0Lm5leHRfbG9jYXRpb24pCgogICAgZm9yIHJlYyBpbiByZXNwLm91dHB1dC5yZWNvcmRzOgogICAgICAgIHJlY19kYXRhID0gcmVjLmRhdGEuZGVjb2RlKCd1dGYtOCcpCiAgICAgICAgcmVjX2pzb24gPSBqc29uLmxvYWRzKHJlY19kYXRhKQogICAgICAgIGNvbnRleHQuZGF0YS5hcHBlbmQoeydUaW1lJzogcmVjX2pzb25bJ3RpbWUnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnU3ltYm9sJzogcmVjX2pzb25bJ3N5bWJvbCddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTZW50aW1lbnQnOiByZWNfanNvblsnc2VudGltZW50J10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xpbmsnOiByZWNfanNvblsnbGluayddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50JzogcmVjX2pzb25bJ2NvbnRlbnQnXX0pCgogICAgY29udGV4dC5kYXRhID0gY29udGV4dC5kYXRhWy1jb250ZXh0LmxpbWl0Ol0KICAgIAogICAgY29sdW1ucyA9IFt7J3RleHQnOiBrZXksICd0eXBlJzogJ29iamVjdCd9IGZvciBrZXkgaW4gWydUaW1lJywgJ1N5bWJvbCcsICdTZW50aW1lbnQnLCAnTGluaycsICdDb250ZW50J11dCiAgICBkYXRhID0gW2xpc3QoaXRlbS52YWx1ZXMoKSkgZm9yIGl0ZW0gaW4gY29udGV4dC5kYXRhXQogICAgcmVzcG9uc2UgPSBbeydjb2x1bW5zJzogY29sdW1ucywKICAgICAgICAgICAgICAgICdyb3dzJzogZGF0YSwKICAgICAgICAgICAgICAgICd0eXBlJzogJ3RhYmxlJ31dCgogICAgcmV0dXJuIHJlc3BvbnNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCg==
        noBaseImagesPull: true
      env:
      - name: V3IO_ACCESS_KEY
        value: eb6798e2-8ad3-43af-bf84-4c0e6f721f80
      - name: V3IO_USERNAME
        value: admin
      - name: V3IO_API
        value: v3io-webapi.default-tenant.svc:8081
      handler: 05-stream-viewer:handler
      runtime: python:3.6
      volumes: []
  source: ''
