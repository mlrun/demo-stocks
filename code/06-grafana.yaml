kind: job
metadata:
  name: grafana-dashboard-deployer
  tag: ''
  hash: 55a3bfe80b6b8402edca799915d1ee267c128252
  project: stocks
spec:
  command: ''
  args: []
  env: []
  default_handler: deploy_dashboard
  entry_points:
    deploy_dashboard:
      name: deploy_dashboard
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: grafana_url
        type: str
        default: http://grafana
      - name: streamview_url
        type: str
        default: http://3.12.231.36:30100
      - name: v3io_container
        type: str
        default: bigdata
      - name: stocks_kv_table
        type: str
        default: stocks/stocks_kv
      - name: stocks_tsdb_table
        type: str
        default: stocks/stocks_tsdb
      - name: stocks_sentiment_tsdb_table
        type: str
        default: stocks/stocks_sentiment_tsdb
      outputs:
      - default: ''
      lineno: 6
  description: ''
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKZnJvbSBncmFmd2l6IGltcG9ydCAqCmltcG9ydCBvcwoKZGVmIGRlcGxveV9kYXNoYm9hcmQoY29udGV4dCwgCiAgICAgICAgICAgICAgICAgICAgIGdyYWZhbmFfdXJsOnN0ciA9ICdodHRwOi8vZ3JhZmFuYScsIAogICAgICAgICAgICAgICAgICAgICBzdHJlYW12aWV3X3VybDpzdHIgPSAnaHR0cDovLzMuMTIuMjMxLjM2OjMwMTAwJywKICAgICAgICAgICAgICAgICAgICAgdjNpb19jb250YWluZXI6c3RyID0gJ2JpZ2RhdGEnLAogICAgICAgICAgICAgICAgICAgICBzdG9ja3Nfa3ZfdGFibGU6c3RyID0gJ3N0b2Nrcy9zdG9ja3Nfa3YnLAogICAgICAgICAgICAgICAgICAgICBzdG9ja3NfdHNkYl90YWJsZTpzdHIgPSAnc3RvY2tzL3N0b2Nrc190c2RiJywKICAgICAgICAgICAgICAgICAgICAgc3RvY2tzX3NlbnRpbWVudF90c2RiX3RhYmxlOnN0ciA9ICdzdG9ja3Mvc3RvY2tzX3NlbnRpbWVudF90c2RiJyk6CiAgICBEYXRhU291cmNlKCdzdHJlYW0tdmlld2VyJywgZnJhbWVzX3VybD1zdHJlYW12aWV3X3VybCkuZGVwbG95KGdyYWZhbmFfdXJsKQogICAgCiAgICBkYXNoID0gRGFzaGJvYXJkKCJzdG9ja3MtdGVzdCIsIHN0YXJ0PSdub3ctMWQnLCBkYXRhU291cmNlPSdJZ3VhemlvJykKCiAgICBkYXNoLnRlbXBsYXRlKG5hbWU9IlNZTUJPTCIsIGxhYmVsPSJTeW1ib2wiLCBxdWVyeT0iZmllbGRzPXN5bWJvbDt0YWJsZT1zdG9ja3Mvc3RvY2tzX2t2O2JhY2tlbmQ9a3Y7Y29udGFpbmVyPWJpZ2RhdGEiKQoKICAgIHRibCA9IFRhYmxlKCd0YmwxJyxzcGFuPTgpLnNvdXJjZSh0YWJsZT1zdG9ja3Nfa3ZfdGFibGUsZmllbGRzPVsnc3ltYm9sJywndm9sdW1lJywgJ3ByaWNlJywnbGFzdF91cGRhdGVkJ10sY29udGFpbmVyPXYzaW9fY29udGFpbmVyKQogICAgbG9nID0gVGFibGUoJ2xvZycsIGRhdGFTb3VyY2U9J3N0cmVhbS12aWV3ZXInLCBzcGFuPTQpCiAgICBkYXNoLnJvdyhbdGJsLGxvZ10pCgogICAgZGFzaC5yb3coW0dyYXBoKG1ldHJpYykuc2VyaWVzKHRhYmxlPXN0b2Nrc190c2RiX3RhYmxlLCBmaWVsZHM9W21ldHJpY10sIGZpbHRlcj0nc3ltYm9sPT0iJFNZTUJPTCInLGNvbnRhaW5lcj12M2lvX2NvbnRhaW5lcikgZm9yIG1ldHJpYyBpbiBbJ3ByaWNlJywndm9sdW1lJ11dKQogICAgZGFzaC5yb3coW0dyYXBoKCdzZW50aW1lbnQnKS5zZXJpZXModGFibGU9c3RvY2tzX3NlbnRpbWVudF90c2RiX3RhYmxlLCBmaWVsZHM9WydzZW50aW1lbnQnXSwgZmlsdGVyPSdzeW1ib2w9PSIkU1lNQk9MIicsIGNvbnRhaW5lcj12M2lvX2NvbnRhaW5lcildKQogICAgCiAgICByZXR1cm4gZGFzaC5kZXBsb3koZ3JhZmFuYV91cmwpCgo=
    base_image: mlrun/mlrun
    commands:
    - python -m pip install git+https://github.com/v3io/grafwiz.git
    code_origin: https://github.com/mlrun/demo-stocks.git#93eb0fdf0dc973ce14d6c0fbce5c7a3516510274:grafana_dashboard_deployer.ipynb
