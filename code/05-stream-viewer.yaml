kind: remote
metadata:
  name: stream-viewer
  tag: ''
  hash: b90d8b8999b54db4e7de136f46cc103d94517822
  project: default
spec:
  command: ''
  args: []
  image: ''
  entry_points:
    init_context:
      name: init_context
      doc: ''
      parameters:
      - name: context
        default: ''
      outputs:
      - default: ''
      lineno: 7
    handler:
      name: handler
      doc: ''
      parameters:
      - name: context
        default: ''
      - name: event
        default: ''
      outputs:
      - default: ''
      lineno: 20
  description: ''
  min_replicas: 1
  max_replicas: 4
  env: []
  base_spec:
    apiVersion: nuclio.io/v1
    kind: Function
    metadata:
      annotations:
        nuclio.io/generated_by: function generated from 24-09-2020 by admin
      labels: {}
      name: stream-viewer
    spec:
      build:
        baseImage: mlrun/mlrun
        commands:
        - pip install v3io
        functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlcgoKaW1wb3J0IHYzaW8uZGF0YXBsYW5lCmltcG9ydCBqc29uCmltcG9ydCBvcwoKZGVmIGluaXRfY29udGV4dChjb250ZXh0KToKICAgIGFjY2Vzc19rZXkgPSBvcy5nZXRlbnYoJ1YzSU9fQUNDRVNTX0tFWScsIE5vbmUpCiAgICBzZXRhdHRyKGNvbnRleHQsICdjb250YWluZXInLCBvcy5nZXRlbnYoJ1YzSU9fQ09OVEFJTkVSJywgJ2JpZ2RhdGEnKSkKICAgIHNldGF0dHIoY29udGV4dCwgJ3N0cmVhbV9wYXRoJywgb3MuZ2V0ZW52KCdTVE9DS1NfU1RSRUFNJywgJ3N0b2Nrcy9zdG9ja3Nfc3RyZWFtJykpCiAgICAKICAgIHYzaW9fY2xpZW50ID0gdjNpby5kYXRhcGxhbmUuQ2xpZW50KGVuZHBvaW50PW9zLmdldGVudignVjNJT19BUEknLCBOb25lKSwgYWNjZXNzX2tleT1hY2Nlc3Nfa2V5KQogICAgcmVzcCA9IHYzaW9fY2xpZW50LnNlZWtfc2hhcmQoY29udGFpbmVyPWNvbnRleHQuY29udGFpbmVyLCBwYXRoPWYne2NvbnRleHQuc3RyZWFtX3BhdGh9LzAnLCBzZWVrX3R5cGU9J0VBUkxJRVNUJykKICAgIHNldGF0dHIoY29udGV4dCwgJ25leHRfbG9jYXRpb24nLCByZXNwLm91dHB1dC5sb2NhdGlvbikKICAgIHNldGF0dHIoY29udGV4dCwgJ2RhdGEnLCBbXSkKICAgIHNldGF0dHIoY29udGV4dCwgJ3YzaW9fY2xpZW50JywgdjNpb19jbGllbnQpIAogICAgc2V0YXR0cihjb250ZXh0LCAnbGltaXQnLCBvcy5nZXRlbnYoJ0xJTUlUJywgMTApKQoKICAgIApkZWYgaGFuZGxlcihjb250ZXh0LCBldmVudCk6CiAgICAKICAgIHJlc3AgPSBjb250ZXh0LnYzaW9fY2xpZW50LmdldF9yZWNvcmRzKGNvbnRhaW5lcj1jb250ZXh0LmNvbnRhaW5lciwgcGF0aD1mJ3tjb250ZXh0LnN0cmVhbV9wYXRofS8wJywgbG9jYXRpb249Y29udGV4dC5uZXh0X2xvY2F0aW9uLCBsaW1pdD1jb250ZXh0LmxpbWl0KQogICAgY29udGV4dC5uZXh0X2xvY2F0aW9uID0gcmVzcC5vdXRwdXQubmV4dF9sb2NhdGlvbgogICAgY29udGV4dC5sb2dnZXIuaW5mbygnbG9jYXRpb246ICVzJywgY29udGV4dC5uZXh0X2xvY2F0aW9uKQoKICAgIGZvciByZWMgaW4gcmVzcC5vdXRwdXQucmVjb3JkczoKICAgICAgICByZWNfZGF0YSA9IHJlYy5kYXRhLmRlY29kZSgndXRmLTgnKQogICAgICAgIHJlY19qc29uID0ganNvbi5sb2FkcyhyZWNfZGF0YSkKICAgICAgICBjb250ZXh0LmRhdGEuYXBwZW5kKHJlY19qc29uKQoKICAgIGNvbnRleHQuZGF0YSA9IGNvbnRleHQuZGF0YVstY29udGV4dC5saW1pdDpdCiAgICAKICAgIGNvbHVtbnMgPSBbeyd0ZXh0Jzoga2V5LCAndHlwZSc6ICdvYmplY3QnfSBmb3Iga2V5IGluIGxpc3QoY29udGV4dC5kYXRhWzBdLmtleXMoKSldCiAgICBkYXRhID0gW2xpc3QoaXRlbS52YWx1ZXMoKSkgZm9yIGl0ZW0gaW4gY29udGV4dC5kYXRhXQogICAgcmVzcG9uc2UgPSBbeydjb2x1bW5zJzogY29sdW1ucywKICAgICAgICAgICAgICAgICdyb3dzJzogZGF0YSwKICAgICAgICAgICAgICAgICd0eXBlJzogJ3RhYmxlJ31dCgogICAgcmV0dXJuIHJlc3BvbnNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCg==
        noBaseImagesPull: true
      env:
      - name: V3IO_ACCESS_KEY
        value: eb6798e2-8ad3-43af-bf84-4c0e6f721f80
      - name: V3IO_USERNAME
        value: admin
      - name: V3IO_API
        value: v3io-webapi.default-tenant.svc:8081
      handler: 05-stream-viewer:handler
      runtime: python:3.6
      volumes: []
  source: ''
